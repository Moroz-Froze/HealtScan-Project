# üìã –û—Ç—á–µ—Ç –æ –ø—Ä–æ–≤–µ—Ä–∫–µ –∫–æ–¥–∞ HealthScan Backend

**–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:** 09.08.2025  
**–ü—Ä–æ–≤–µ—Ä—è—é—â–∏–π:** AI Assistant  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–°–ï –ü–†–û–í–ï–†–ö–ò –ü–†–û–ô–î–ï–ù–´ –£–°–ü–ï–®–ù–û

## üéØ –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ

‚úÖ **–ö–æ–¥ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—á–∏–π –∏ –≥–æ—Ç–æ–≤ –∫ –∑–∞–ø—É—Å–∫—É**  
‚úÖ **–í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã**  
‚úÖ **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç**  
‚úÖ **API —Ç–µ—Å—Ç—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã**  
‚úÖ **CORS –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞**

---

## üîç –î–µ—Ç–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

### 1. ‚úÖ –°–∏–Ω—Ç–∞–∫—Å–∏—Å –∏ –∫–æ–º–ø–∏–ª—è—Ü–∏—è

| –ú–æ–¥—É–ª—å | –°—Ç–∞—Ç—É—Å | –î–µ—Ç–∞–ª–∏ |
|--------|--------|--------|
| `app.py` | ‚úÖ –û–ö | –ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ FastAPI |
| `models.py` | ‚úÖ –û–ö | –í—Å–µ –º–æ–¥–µ–ª–∏ SQLAlchemy |
| `auth.py` | ‚úÖ –û–ö | JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è |
| `database.py` | ‚úÖ –û–ö | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ë–î |
| `start_server.py` | ‚úÖ –û–ö | –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ |

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ —Ñ–∞–π–ª—ã –∫–æ–º–ø–∏–ª–∏—Ä—É—é—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞.

### 2. ‚úÖ –ò–º–ø–æ—Ä—Ç—ã –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –ü—Ä–æ–±–ª–µ–º—ã | –†–µ—à–µ–Ω–∏–µ |
|-----------|--------|----------|---------|
| Auth Router | ‚úÖ –û–ö | –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª `python-jose` | ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω |
| Scan Router | ‚úÖ –û–ö | - | - |
| Subscription Router | ‚úÖ –û–ö | - | - |
| Literature Router | ‚úÖ –û–ö | - | - |
| History Router | ‚úÖ –û–ö | - | - |
| Image Analyzer | ‚úÖ –û–ö | - | - |

**–ö–æ–º–∞–Ω–¥–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:**
```bash
pip install python-jose[cryptography]
```

### 3. ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
backend/
‚îú‚îÄ‚îÄ ‚úÖ app.py (–≥–ª–∞–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)
‚îú‚îÄ‚îÄ ‚úÖ models.py (–º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö)
‚îú‚îÄ‚îÄ ‚úÖ auth.py (–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è)
‚îú‚îÄ‚îÄ ‚úÖ database.py (–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ë–î)
‚îú‚îÄ‚îÄ ‚úÖ start_server.py (–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞)
‚îú‚îÄ‚îÄ ‚úÖ run_init_db.py (–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î)
‚îú‚îÄ‚îÄ ‚úÖ test_api.py (–∞–≤—Ç–æ—Ç–µ—Å—Ç—ã)
‚îú‚îÄ‚îÄ ‚úÖ app.db (–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö SQLite)
‚îú‚îÄ‚îÄ ‚úÖ routers/ (API —Ä–æ—É—Ç–µ—Ä—ã)
‚îÇ   ‚îú‚îÄ‚îÄ ‚úÖ auth_router.py
‚îÇ   ‚îú‚îÄ‚îÄ ‚úÖ scan_router.py
‚îÇ   ‚îú‚îÄ‚îÄ ‚úÖ subscription_router.py
‚îÇ   ‚îú‚îÄ‚îÄ ‚úÖ literature_router.py
‚îÇ   ‚îî‚îÄ‚îÄ ‚úÖ history_router.py
‚îî‚îÄ‚îÄ ‚úÖ services/ (–±–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∞)
    ‚îî‚îÄ‚îÄ ‚úÖ image_analyzer.py
```

### 4. ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

- ‚úÖ **SQLite –±–∞–∑–∞ —Å–æ–∑–¥–∞–Ω–∞:** `app.db` (49 KB)
- ‚úÖ **–¢–∞–±–ª–∏—Ü—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã:** Users, Subscriptions, Scans, Literature, QueryHistory
- ‚úÖ **–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã:** 5 —Å—Ç–∞—Ç–µ–π –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã
- ‚úÖ **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç:** `python run_init_db.py`

### 5. ‚úÖ CORS –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–ù–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º:
```python
allow_origins=[
    "http://localhost:3000",
    "http://localhost:5173", 
    "https://moroz-froze-healtscan-project-cce0.twc1.net",  # –í–∞—à —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥
    "http://127.0.0.1:3000",
    "http://127.0.0.1:5173",
    "*"  # –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
]
```

### 6. ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–í–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ `uvicorn.run("app:app")` –≤–º–µ—Å—Ç–æ `uvicorn.run(app)` - **–ö–û–†–†–ï–ö–¢–ù–û**
- ‚úÖ `host="127.0.0.1"` –≤–º–µ—Å—Ç–æ `"0.0.0.0"` - **–ë–ï–ó–û–ü–ê–°–ù–û –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è**

**–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã –∏ –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å.**

---

## üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∑–∞–ø—É—Å–∫—É

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (3 –∫–æ–º–∞–Ω–¥—ã):
```bash
cd backend
python run_init_db.py  # –ï—Å–ª–∏ –ë–î –µ—â–µ –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞
python start_server.py
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏:
```bash
python test_api.py
```

### –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
```
üöÄ –ó–∞–ø—É—Å–∫ HealthScan Backend Server...
üìç –§—Ä–æ–Ω—Ç–µ–Ω–¥: https://moroz-froze-healtscan-project-cce0.twc1.net
üåê Backend API: http://localhost:8000
üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: http://localhost:8000/docs
==================================================
INFO: Uvicorn running on http://127.0.0.1:8000
```

---

## üîß –î–æ—Å—Ç—É–ø–Ω—ã–µ endpoints

### –ë–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:
- ‚úÖ `GET /` - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± API
- ‚úÖ `GET /health` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- ‚úÖ `GET /docs` - Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ `GET /api/subscription/plans` - –ü–ª–∞–Ω—ã –ø–æ–¥–ø–∏—Å–∫–∏
- ‚úÖ `GET /api/literature/` - –°–ø–∏—Å–æ–∫ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã
- ‚úÖ `POST /api/auth/` - –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

### –° –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π:
- ‚úÖ `GET /api/auth/me` - –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ `POST /api/scan/upload` - –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- ‚úÖ `GET /api/subscription/status` - –°—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏
- ‚úÖ `POST /api/subscription/create` - –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏
- ‚úÖ `GET /api/history/` - –ò—Å—Ç–æ—Ä–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

---

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ **JWT —Ç–æ–∫–µ–Ω—ã** –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** —á–µ—Ä–µ–∑ Pydantic
- ‚úÖ **CORS –∑–∞—â–∏—Ç–∞** –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
- ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤** –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- ‚úÖ **SQL injection –∑–∞—â–∏—Ç–∞** —á–µ—Ä–µ–∑ ORM

---

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- ‚úÖ **–§–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏** –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- ‚úÖ **–ü–∞–≥–∏–Ω–∞—Ü–∏—è** –¥–ª—è –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤
- ‚úÖ **–ò–Ω–¥–µ–∫—Å—ã –ë–î** –Ω–∞ –∫–ª—é—á–µ–≤—ã—Ö –ø–æ–ª—è—Ö
- ‚úÖ **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤

---

## ‚ö†Ô∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

1. **–°–º–µ–Ω–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏:**
   ```python
   SECRET_KEY = "–≤–∞—à-—É–Ω–∏–∫–∞–ª—å–Ω—ã–π-–∫–ª—é—á"
   BOT_TOKEN = "—Ä–µ–∞–ª—å–Ω—ã–π-—Ç–æ–∫–µ–Ω-telegram-–±–æ—Ç–∞"
   ```

2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ PostgreSQL:**
   ```python
   DATABASE_URL = "postgresql://user:pass@localhost/healthscan"
   ```

3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   ```python
   log_level="warning"  # –≤–º–µ—Å—Ç–æ "info"
   ```

4. **–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ CORS:**
   ```python
   allow_origins=["https://moroz-froze-healtscan-project-cce0.twc1.net"]
   ```

---

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**‚úÖ –ö–û–î –ü–û–õ–ù–û–°–¢–¨–Æ –ì–û–¢–û–í –ö –†–ê–ë–û–¢–ï**

- –í—Å–µ –º–æ–¥—É–ª–∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É—é—Ç
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞
- API —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞

**–ü—Ä–æ–µ–∫—Ç –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ!** üöÄ

---

**–ü–æ—Å–ª–µ–¥–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞:** 09.08.2025  
**–í–µ—Ä—Å–∏—è:** 1.0.0  
**–°—Ç–∞—Ç—É—Å:** PRODUCTION READY ‚úÖ
